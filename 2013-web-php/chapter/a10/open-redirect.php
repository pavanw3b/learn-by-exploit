<?php
	if(isset($_GET['url']))
		header('Location:' . $_GET['url']);
?>
<!DOCTYPE html>
<html lang="en">
<head>
	<?php require_once('../../include/head-include.php'); ?>
	<title>Open Redirection | Unvalidated Redirect &amp; Forwards | LearnByExploit</title>
</head>
<body>
	<!-- wrapper -->
	<div class="wrapper">
		<?php require_once('../../include/header.php'); ?>
		<!-- shell -->
		<div class="shell">
			<!-- main -->
			<div class="main">
				<section class="content">
					<h3>Click the button to forward to Google</h3>
					<form method="GET">
						<p>
							<input type="hidden" name="url" value="https://google.co.in" />
							<input type="submit" value=" Go to Google " />
						</p>
					</form>
					<br />
					<hr />
					<h3>Background</h3>
					<p>
						<ul>
							<li>The destination URL is hidden in the form</li>
							<li>Play around it.</li>
							<li>The form method is GET.</li>
							<li>Action URL is same as the current one.</li>
							<li>The resultant URL will be &lt;CURRENT_URL&gt;?url=&lt;URL&gt;</li>
						</ul>
					</p>
					<h3>Solution</h3>
					<p>Try accessing <a href="<?php echo $_SERVER['PHP_SELF'];?>?url=https://google.co.in">/?url=https://google.co.in</p>
				</section>
			</div>
			<!-- end of main -->
		</div>
		<!-- end of shell -->	
		<?php require_once('../../include/footer.php'); ?>
	</div>
	<!-- end of wrapper -->
</body>
</html>