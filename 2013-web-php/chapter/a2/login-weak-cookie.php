<?php
if(isset($_POST['submit'])) {
	
}

?>
<!DOCTYPE html>
<html lang="en">
<head>
	<?php require_once('../../include/head-include.php'); ?>
	<title>Weak Cookie | Broken Authentication | LearByExploit</title>
</head>
<body>
	<!-- wrapper -->
	<div class="wrapper">
		<?php require_once('../../include/header.php'); ?>
		<!-- shell -->
		<div class="shell">
			<!-- main -->
			<div class="main">
				<section class="content">
					<h3>Challenge:</h3>
					<p>Try to login as User id #2 without using the credential. Login as User id #1 to understand how the application handles authentication. Look at the cookies.</p>
					<table>
						<thead>
							<tr><td>User #</td><td>Username</td><td>Password</td></tr>
						</thead>
						<tbody>
							<tr><td>1</td><td>foo@example.com</td><td>password@123</td></tr>
							<tr><td>2</td><td>foo@example.com</td><td>password@000</td></tr>
						</tbody>
					</table>
					<?php if(!$isAuthenticated) { ?>
						<form method="POST">
							<table>
								<tr><td><input type="text" name="email" placeholder="foo@example.com" /></td></tr>
								<tr><td><input type="password" placeholder="password@123" name="password" /></td></tr>
								<tr><td><input type="submit" value=" Login " name="submit" /></td></tr>
							</table>
						</form>
					<?php
					}
					?>
					
					<hr />
					<h3>Background</h3>
					<p>The entered credentials are put dynamically in a SELECT query like below and checks if it returns more than one query.</p>
					<pre>
$email = $_POST['email'];
$password = $_POST['password'];
$query = "SELECT user_id FROM user WHERE email = '".$email."' AND password = '".$password."'";
			</pre>
					<h3>Solution</h3>
					<p>
						Using universal truth &amp; only one parameter:<br />
						Username: aa' or 'a'='a'#<br />
						Password: anything
					</p>
					<p>
						Using universal truth in both parameters:<br />
						Username: email=aa' or 'a'='a<br />
						password=aa' or 'a'='a
					</p>
				</section>
			</div>
			<!-- end of main -->
		</div>
		<!-- end of shell -->	
		<?php require_once('../../include/footer.php'); ?>
	</div>
	<!-- end of wrapper -->
</body>
</html>