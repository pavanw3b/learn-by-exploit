<?php

/*
 * City Search API
 * AJAX called from city search.
 * Accepts part of city name
 * Returns JSON city results matching the text search
 */

 $search = $_REQUEST['search'];
 $response = array(
 				"success" => false,
 				"msg" => "No Users found for the user id."
 			);

 if(0 < strlen($search)) {
 	require_once('../../config/database.php');
 	$con = mysqli_connect($host, $user, $password, $database, $port) or die("Database Connection error.<br />Please review the settings under /config/database.php<br />The current settings are<br />host: ".$host."<br />user: ".$user."<br />password: ".$password.'<br />db: '.$database.'<br />port: '.$port.'<br />socket: '.$socket);
 	$query = 'SELECT full_name, email, phone FROM victim_user WHERE user_id ='.$search;
	$result = mysqli_query($con, $query) or die(mysqli_error($con)."<br />The query is<br />".$query);
	if(0 < $result->num_rows) {
		$response['success'] = true;
		$response['msg'] = "The user found";
		$response['users'] = array();
		while($row = $result->fetch_assoc()) {
			array_push($response['users'], array(
					"full_name" => $row['full_name'],
					"email" => $row['email'],
					"phone" => $row['phone'],
				));
		}
		
	}
 }
header('Content-type: application/json');
echo json_encode($response);
?>