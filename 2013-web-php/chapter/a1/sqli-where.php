<?php

if(isset($_GET['color_name'])) {
	require_once('../../config/database.php');
	$con = mysqli_connect($host, $user, $password, $database, $port, $socket) or die("Database Connection error.<br />Please review the settings under /config/database.php<br />The current settings are<br />host: ".$host."<br />user: ".$user."<br />password: ".$password.'<br />db: '.$database.'<br />port: '.$port.'<br />socket: '.$socket);
	$query = "SELECT color_id, color_name, color_code FROM color WHERE color_name LIKE '%".strtolower($_GET['color_name'])."%';";
	$result = mysqli_query($con, $query) or die("Error in query<br />".mysqli_error($con)."<br />The query is<br />SELECT color_id, color_code FROM color WHERE color_name = '".strtolower($_GET['color_name'])."';");
}

?>
<!DOCTYPE html>
<html lang="en">
<head>
	<?php require_once('../../include/head-include.php'); ?>
	<title>OWASP Top 10 in php | The darkw3b</title>
</head>
<body>
	<!-- wrapper -->
	<div class="wrapper">
		<?php require_once('../../include/header.php'); ?>
		<!-- shell -->
		<div class="shell">
			<!-- main -->
			<div class="main">
				<section class="content">
					<h2>Story: VIBGYOR Directory</h2>
					<p>Search for any of the Rainbow colors to get it's hex decimal color code.</p>
					<form>
						<input type="text" placeholder="Color Name, eg: blue" name="color_name" />
						<input type="submit" value=" Search " />
					</form>
					<br />
					<?php 
					if(isset($_GET['color_name'])) {
						if(0 < $result->num_rows) {
							echo "<table border=\"1\"><tr><td>Id</td><td>Name</td><td>Code</td><td>Color</td></tr>";
							while($row = $result->fetch_assoc()) {
								echo "<tr><td>".$row['color_id']."</td><td>".$row['color_name']."</td><td>".$row['color_code']."</td><td style=\"background: ".$row['color_code']."\"></td></tr>";
							}
							echo "</table>";
							echo "<br /><p>The query ran was</p><p>".$query."</p>";
						}
						else{
							echo "Not found";
						}
					}

					?>
					<hr />
					<h3>Background</h3>
					<p>The entered color will be searched in a table which holds the 7 color name and the respective color codes.</p>
					<p>The code looks something like </p>
					<code>
						mysqli_query("SELECT color_id, color_code FROM color WHERE color_name LIKE '%&quot;.$_GET['color_name'].&quot;%');
					</code>
				</section>
			</div>
			<!-- end of main -->
		</div>
		<!-- end of shell -->	
		<?php require_once('../../include/footer.php'); ?>
	</div>
	<!-- end of wrapper -->
</body>
</html>